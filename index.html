<!DOCTYPE html>
<html lang="es" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Med & Beauty | Expertos en Medicina Estética</title>
    <link rel="icon" href="/products/medAndBeautyLogo.png" type="image/x-icon">
    <script src="/config.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gold: {
                            DEFAULT: '#c5a560',
                            light: '#e6d0a0',
                            hover: '#b08d45'
                        },
                        dark: {
                            DEFAULT: '#111111',
                            light: '#2a2a2a'
                        },
                        cream: '#faf9f6'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif']
                    },
                    backgroundImage: {
                        'gradient-radial': 'radial-gradient(var(--tw-gradient-stops))',
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts: Inter + Playfair Display (Luxury Combo) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Swiper -->
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <style>
        body { font-family: 'Inter', sans-serif; background-color: #faf9f6; }
        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; }

        /* Elegant Loader */
        .loader-line {
            width: 100%;
            height: 2px;
            position: relative;
            overflow: hidden;
            background-color: #f0f0f0;
        }
        .loader-line:before {
            content: "";
            position: absolute;
            left: -50%;
            height: 2px;
            width: 40%;
            background-color: #c5a560;
            animation: lineAnim 1s linear infinite;
        }
        @keyframes lineAnim {
            0% { left: -40%; }
            50% { left: 20%; width: 80%; }
            100% { left: 100%; width: 100%; }
        }

        /* Marquee Animation */
        .brands-track { animation: scroll 60s linear infinite; }
        .brands-wrapper:hover .brands-track { animation-play-state: paused; }
        @keyframes scroll { 0% { transform: translateX(0); } 100% { transform: translateX(calc(-150px * 14)); } }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c5a560; border-radius: 3px; }

        /* Floating Chat */
        .chat-widget-enter { opacity: 0; transform: translateY(20px) scale(0.95); pointer-events: none; }
        .chat-widget-active { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
    </style>
</head>
<body class="antialiased text-dark-light">

<!-- Preloader de Lujo -->
<div id="preloader" class="fixed inset-0 bg-white z-[9999] flex flex-col items-center justify-center transition-opacity duration-700">
    <div class="text-4xl font-serif text-dark font-bold mb-4 tracking-widest">MB</div>
    <div class="w-24 h-[1px] bg-gray-200 overflow-hidden relative">
        <div class="absolute inset-y-0 left-0 bg-gold w-full animate-[spin_1.5s_linear_infinite] origin-left" style="animation: loading-bar 1.5s ease-in-out infinite;"></div>
    </div>
    <style>@keyframes loading-bar { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }</style>
</div>

<!-- Top Bar (Información) -->
<div class="bg-dark text-white text-xs py-2 px-6 flex justify-between items-center tracking-wide">
    <span class="opacity-80 hidden md:inline">Distribuidor Autorizado de Marcas Premium</span>
    <div class="flex gap-4 ml-auto opacity-80">
        <a href="#" class="hover:text-gold transition-colors">Soporte</a>
        <a href="#" class="hover:text-gold transition-colors">Envíos</a>
    </div>
</div>

<!-- Header Transparente a Blanco -->
<header id="main-header" class="sticky top-0 z-50 bg-white/80 backdrop-blur-lg border-b border-gray-100 transition-all duration-300">
    <nav class="container mx-auto px-6 h-20 flex justify-between items-center">
        <!-- Logo -->
        <a href="#" class="flex items-center gap-3 group">
            <img src="/products/medAndBeautyLogo.png" alt="MB Logo" class="h-10 w-auto object-contain">
            <div class="flex flex-col">
                <span class="font-serif text-xl font-bold leading-none text-dark group-hover:text-gold transition-colors">Med & Beauty</span>
                <span class="text-[0.6rem] uppercase tracking-[0.2em] text-gray-400">Professional Supply</span>
            </div>
        </a>

        <!-- Navigation Desktop -->
        <div class="hidden md:flex items-center gap-10 text-sm uppercase tracking-widest font-medium text-gray-500">
            <a href="#" class="hover:text-dark relative after:content-[''] after:absolute after:-bottom-1 after:left-0 after:w-0 after:h-[1px] after:bg-gold after:transition-all hover:after:w-full">Inicio</a>
            <a href="#catalogo" class="hover:text-dark relative after:content-[''] after:absolute after:-bottom-1 after:left-0 after:w-0 after:h-[1px] after:bg-gold after:transition-all hover:after:w-full">Colección</a>
            <a href="#marcas" class="hover:text-dark relative after:content-[''] after:absolute after:-bottom-1 after:left-0 after:w-0 after:h-[1px] after:bg-gold after:transition-all hover:after:w-full">Marcas</a>
        </div>

        <!-- Icons -->
        <div class="flex items-center gap-6">
            <a href="/catalog.html" class="text-dark hover:text-gold transition-colors"><i class="fa-regular fa-user text-lg"></i></a>
        </div>
    </nav>

</header>

<main>
    <!-- Hero Section: Editorial Style -->
    <section class="relative min-h-[85vh] flex items-center bg-cream overflow-hidden">
        <!-- Background Decoration -->
        <div class="absolute top-0 right-0 w-2/3 h-full bg-white skew-x-12 translate-x-20 z-0 hidden lg:block"></div>

        <div class="container mx-auto px-6 relative z-10 grid lg:grid-cols-2 gap-12 items-center h-full py-12">
            <!-- Text Content -->
            <div class="order-2 lg:order-1 space-y-8 animate-[fadeIn_1s_ease-out]">
                <div class="inline-flex items-center gap-3">
                    <span class="h-[1px] w-12 bg-gold"></span>
                    <span class="text-gold uppercase tracking-[0.2em] text-xs font-semibold">Solo Profesionales</span>
                </div>
                <h1 class="text-5xl md:text-7xl leading-[1.1] text-dark">
                    La ciencia de la <br>
                    <span class="italic text-gold">belleza eterna.</span>
                </h1>
                <p class="text-gray-500 text-lg leading-relaxed max-w-md font-light">
                    Distribución exclusiva de rellenos dérmicos, toxinas y bioestimuladores. Logística certificada para garantizar la integridad de tu práctica.
                </p>
                <div class="flex flex-col sm:flex-row gap-4 pt-4">
                    <a href="#catalogo" class="px-8 py-4 bg-dark text-white text-sm uppercase tracking-widest hover:bg-gold transition-colors text-center shadow-xl shadow-gray-200">
                        Explorar Catálogo
                    </a>
                    <a href="#marcas" class="px-8 py-4 border border-dark text-dark text-sm uppercase tracking-widest hover:bg-dark hover:text-white transition-colors text-center">
                        Ver Marcas
                    </a>
                </div>
            </div>

            <!-- Image Carousel (Vertical/Elegant) -->
            <div class="order-1 lg:order-2 h-[500px] lg:h-[700px] w-full relative">
                <div class="swiper hero-swiper w-full h-full shadow-2xl rounded-sm overflow-hidden">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide relative">
                            <img src="https://images.unsplash.com/photo-1576091160399-112ba8d25d1d?q=80&w=2070&auto=format&fit=crop" class="w-full h-full object-cover grayscale-[20%] contrast-125">
                            <div class="absolute inset-0 bg-gradient-to-t from-black/30 to-transparent"></div>
                        </div>
                        <div class="swiper-slide relative">
                            <img src="https://images.unsplash.com/photo-1584308666744-24d5c474f2ae?q=80&w=2030&auto=format&fit=crop" class="w-full h-full object-cover grayscale-[20%] contrast-125">
                        </div>
                    </div>
                    <!-- Custom Nav -->
                    <div class="absolute bottom-0 left-0 bg-white p-6 z-20 hidden md:flex gap-4">
                        <div class="swiper-button-prev !static !w-10 !h-10 !m-0 !text-dark after:!text-lg border border-gray-200 hover:border-gold transition-colors"></div>
                        <div class="swiper-button-next !static !w-10 !h-10 !m-0 !text-dark after:!text-lg border border-gray-200 hover:border-gold transition-colors"></div>
                    </div>
                </div>
                <!-- Decor element -->
                <div class="absolute -bottom-6 -right-6 w-32 h-32 border-2 border-gold/30 -z-10 hidden lg:block"></div>
            </div>
        </div>
    </section>

    <!-- Brands Ticker (Minimal) -->
    <section id="marcas" class="py-8 bg-white border-b border-gray-100 overflow-hidden">
        <div class="brands-wrapper relative flex w-full">
            <div class="brands-track flex items-center gap-16 px-4" id="brands-track">
                <!-- Brands Injected via JS -->
            </div>
            <div class="absolute top-0 left-0 h-full w-32 bg-gradient-to-r from-white to-transparent z-10"></div>
            <div class="absolute top-0 right-0 h-full w-32 bg-gradient-to-l from-white to-transparent z-10"></div>
        </div>
    </section>

    <!-- Catalog Section -->
    <section id="catalogo" class="py-24 bg-cream relative">
        <div class="container mx-auto px-6">
            <!-- Section Header -->
            <div class="text-center max-w-3xl mx-auto mb-16">
                <span class="text-gold uppercase tracking-widest text-xs font-bold mb-3 block">Selección Premium</span>
                <h2 class="text-4xl md:text-5xl text-dark mb-6">Nuestra Colección</h2>
                <p class="text-gray-500 font-light">Explora productos cuidadosamente seleccionados para resultados estéticos superiores.</p>
            </div>

            <!-- Filters (Minimal Tabs) -->
            <div class="flex justify-center mb-12 flex-wrap gap-6 text-sm uppercase tracking-wider text-gray-400 font-medium">
                <button class="filter-btn text-dark border-b-2 border-gold pb-1" data-filter="todos">Todo</button>
                <div class="relative group">
                    <button class="hover:text-gold transition-colors flex items-center gap-1">
                        Filtrar por Marca <i class="fa-solid fa-chevron-down text-[10px]"></i>
                    </button>
                    <!-- Dropdown -->
                    <div class="absolute left-1/2 -translate-x-1/2 top-full mt-2 w-48 bg-white shadow-xl p-2 rounded-sm hidden group-hover:block z-20 border border-gray-100">
                        <select id="brand-filter" class="w-full p-2 text-gray-600 bg-transparent outline-none cursor-pointer">
                            <option value="todos">Todas las marcas</option>
                        </select>
                    </div>
                </div>
                <select id="sort-by" class="bg-transparent hover:text-gold transition-colors cursor-pointer outline-none">
                    <option value="relevancia">Ordenar por: Relevancia</option>
                    <option value="precio_asc">Precio: Bajo - Alto</option>
                    <option value="precio_desc">Precio: Alto - Bajo</option>
                </select>
            </div>

            <!-- Product Grid (Clean Layout) -->
            <div id="product-grid" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-x-8 gap-y-12">
                <!-- Dynamic Products -->
                <div class="col-span-full flex flex-col items-center py-20 text-gray-300">
                    <div class="w-12 h-12 border-2 border-gray-200 border-t-gold rounded-full animate-spin mb-4"></div>
                    <span class="font-serif text-gray-400 italic">Cargando catálogo...</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Banner -->
    <section class="bg-dark text-white py-20">
        <div class="container mx-auto px-6 grid md:grid-cols-3 gap-12 text-center divide-y md:divide-y-0 md:divide-x divide-gray-800">
            <div class="px-6">
                <i class="fa-solid fa-gem text-3xl text-gold mb-6"></i>
                <h3 class="text-xl mb-3">Calidad Certificada</h3>
                <p class="text-gray-400 text-sm font-light leading-relaxed">Todos nuestros productos cuentan con registro sanitario y garantía de origen.</p>
            </div>
            <div class="px-6 pt-8 md:pt-0">
                <i class="fa-solid fa-temperature-arrow-down text-3xl text-gold mb-6"></i>
                <h3 class="text-xl mb-3">Cadena de Frío</h3>
                <p class="text-gray-400 text-sm font-light leading-relaxed">Empaque especializado y monitoreo de temperatura para toxinas y bioactivos.</p>
            </div>
            <div class="px-6 pt-8 md:pt-0">
                <i class="fa-solid fa-credit-card text-3xl text-gold mb-6"></i>
                <h3 class="text-xl mb-3">Compra Segura</h3>
                <p class="text-gray-400 text-sm font-light leading-relaxed">Procesamiento de pagos encriptado y facturación inmediata.</p>
            </div>
        </div>
    </section>
</main>

<!-- Footer de Lujo -->
<footer id="footer" class="bg-white pt-20 pb-10 border-t border-gray-100">
    <div class="container mx-auto px-6">
        <div class="grid md:grid-cols-12 gap-12 mb-16">
            <!-- Brand Info -->
            <div class="md:col-span-4 space-y-6">
                <a href="#" class="inline-block">
                    <img src="/products/medAndBeautyLogo.png" alt="MB" class="h-12 w-auto grayscale opacity-80 hover:grayscale-0 transition-all">
                </a>
                <p class="text-gray-500 font-light leading-relaxed">
                    Redefiniendo el estándar en suministros médicos. <br>
                    Compromiso inquebrantable con la calidad y el servicio al profesional de la salud.
                </p>
                <div class="flex gap-4">
                    <a href="#" class="w-10 h-10 border border-gray-200 flex items-center justify-center text-gray-400 hover:bg-dark hover:text-white hover:border-dark transition-all rounded-full"><i class="fa-brands fa-instagram"></i></a>
                    <a href="#" class="w-10 h-10 border border-gray-200 flex items-center justify-center text-gray-400 hover:bg-dark hover:text-white hover:border-dark transition-all rounded-full"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="#" class="w-10 h-10 border border-gray-200 flex items-center justify-center text-gray-400 hover:bg-dark hover:text-white hover:border-dark transition-all rounded-full"><i class="fa-brands fa-whatsapp"></i></a>
                </div>
            </div>

            <!-- Links -->
            <div class="md:col-span-2 md:col-start-6">
                <h4 class="text-dark font-bold mb-6 tracking-widest uppercase text-xs">Explorar</h4>
                <ul class="space-y-4 text-sm text-gray-500 font-light">
                    <li><a href="#" class="hover:text-gold transition-colors">Inicio</a></li>
                    <li><a href="#catalogo" class="hover:text-gold transition-colors">Catálogo</a></li>
                    <li><a href="#marcas" class="hover:text-gold transition-colors">Marcas</a></li>
                    <li><a href="#" class="hover:text-gold transition-colors">Blog Médico</a></li>
                </ul>
            </div>

            <div class="md:col-span-2">
                <h4 class="text-dark font-bold mb-6 tracking-widest uppercase text-xs">Legal</h4>
                <ul class="space-y-4 text-sm text-gray-500 font-light">
                    <li><a href="#" class="hover:text-gold transition-colors">Términos de Servicio</a></li>
                    <li><a href="#" class="hover:text-gold transition-colors">Política de Privacidad</a></li>
                    <li><a href="#" class="hover:text-gold transition-colors">Envíos y Devoluciones</a></li>
                </ul>
            </div>

            <div class="md:col-span-3">
                <h4 class="text-dark font-bold mb-6 tracking-widest uppercase text-xs">Contacto</h4>
                <ul class="space-y-4 text-sm text-gray-500 font-light">
                    <li class="flex items-start gap-3">
                        <i class="fa-solid fa-location-dot text-gold mt-1"></i>
                        <span>Oficinas Centrales<br>Ciudad de México, MX</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fa-solid fa-phone text-gold"></i>
                        <span>312-201-4849</span>
                    </li>
                    <li class="flex items-center gap-3">
                        <i class="fa-solid fa-envelope text-gold"></i>
                        <span>dinmecol@gmail.com</span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="border-t border-gray-100 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-gray-400 font-light">
            <p>&copy; 2025 Med & Beauty. Todos los derechos reservados.</p>
            <div class="flex gap-4">
                <i class="fa-brands fa-cc-visa text-xl"></i>
                <i class="fa-brands fa-cc-mastercard text-xl"></i>
                <i class="fa-brands fa-cc-amex text-xl"></i>
            </div>
        </div>
    </div>
</footer>

<!-- Botón Flotante Chat (Estilo Minimal) -->
<div class="fixed bottom-8 right-8 z-40 flex flex-col items-end gap-4">
    <div id="chat-widget" class="chat-widget-enter bg-white w-80 md:w-96 shadow-2xl rounded-sm border border-gray-100 flex flex-col overflow-hidden transition-all duration-300 origin-bottom-right h-[450px]">
        <div class="bg-dark text-white p-4 flex justify-between items-center">
            <span class="font-serif italic text-lg">Concierge MB</span>
            <button id="close-chat" class="text-gray-400 hover:text-white"><i class="fa-solid fa-times"></i></button>
        </div>
        <div id="chat-messages" class="flex-1 p-4 bg-gray-50 overflow-y-auto space-y-3 text-sm">
            <div class="bg-white p-3 shadow-sm border border-gray-100 text-gray-600 max-w-[90%] self-start">
                Bienvenido a Med & Beauty. ¿En qué puedo asistirle hoy, Doctor?
            </div>
        </div>
        <form id="chat-form" class="p-3 bg-white border-t border-gray-100 flex">
            <input type="text" id="chat-input" placeholder="Escriba su consulta..." class="flex-1 bg-transparent p-2 outline-none text-sm">
            <button type="submit" class="text-gold hover:text-dark px-3 transition-colors font-serif italic">Enviar</button>
        </form>
    </div>

    <button id="chat-toggle" class="group flex items-center gap-3 bg-dark text-white px-5 py-3 rounded-full shadow-lg hover:bg-gold transition-all duration-300">
        <span class="max-w-0 overflow-hidden group-hover:max-w-xs transition-all duration-500 whitespace-nowrap text-sm tracking-wide">Asistente Virtual</span>
        <i class="fa-solid fa-comment-dots text-xl"></i>
    </button>
</div>

<!-- Script Logic -->
<script>
    // Productos cargados desde DynamoDB (temporal hasta tener API Gateway)
    let PRODUCTS = [];

    // --- Init ---
    window.addEventListener('load', () => {
        document.getElementById('preloader').style.opacity = '0';
        setTimeout(() => document.getElementById('preloader').remove(), 700);
    });

    document.addEventListener('DOMContentLoaded', () => {
        // Swiper
        new Swiper('.hero-swiper', {
            loop: true,
            effect: 'fade',
            autoplay: { delay: 6000 },
            navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
        });

        // Load Data
        fetchProducts();

        // Chat
        initChat();

        // Brands Infinite Loop
        renderBrands();
    });

    const BRAND_LOGOS = [
        "https://s3-eu-west-1.amazonaws.com/tpd/logos/5f69ef1790dce900016b4c7f/0x0.png",
        "https://belotero.co.nz/wp-content/themes/belotero/assets/img/Belotero%20HAF.png",
        "https://cdn.cookielaw.org/logos/9eb64978-23c0-4924-97a4-03eb6aab1106/a6465f03-5c73-498e-b290-d8543cc0efa1/117bd58d-3e9d-4020-817c-f97ad8ff7b49/Restylane.png",
        "https://www.sweye.com/wp-content/uploads/2019/05/gem20170813juvederm-5.png",
        "https://radiesse.com/app/uploads/2021/10/radiesse-injectables-logo-dark-teal@3x.png",
        "https://cosmetic-skin-care.co.uk/wp-content/uploads/2023/08/teoxane-logo.png",
        "https://www.kayaldermatology.com/wp-content/uploads/2020/01/Sculptra.png"
    ];

    function renderBrands() {
        const track = document.getElementById('brands-track');
        const list = [...BRAND_LOGOS, ...BRAND_LOGOS, ...BRAND_LOGOS];
        track.innerHTML = list.map(src => `
            <div class="flex-shrink-0 w-32 h-12 flex items-center justify-center opacity-40 hover:opacity-100 grayscale hover:grayscale-0 transition-all duration-500 cursor-pointer">
                <img src="${src}" class="max-w-full max-h-full object-contain">
            </div>
        `).join('');
    }

    async function fetchProducts() {
        try {
            const apiUrl = window.MB_CONFIG?.API_ENDPOINT || 'https://nf9mctqixl.execute-api.us-east-1.amazonaws.com';
            const res = await fetch(`${apiUrl}/products`);
            PRODUCTS = await res.json();
            
            populateFilters(PRODUCTS);
            renderProducts(PRODUCTS);
            setupFilters(PRODUCTS);
        } catch (error) {
            console.error('Error cargando productos:', error);
            document.getElementById('product-grid').innerHTML = `
                <p class="col-span-full text-center py-10 text-gray-400 font-light italic">
                    Cargando catálogo...
                </p>`;
        }
    }

    function populateFilters(products) {
        const select = document.getElementById('brand-filter');
        const brands = [...new Set(products.map(p => p.brand))].sort();
        brands.forEach(b => {
            const opt = document.createElement('option');
            opt.value = b;
            opt.textContent = b;
            select.appendChild(opt);
        });
    }

    function renderProducts(products) {
        const grid = document.getElementById('product-grid');
        if(products.length === 0) {
            grid.innerHTML = '<p class="col-span-full text-center py-10 text-gray-400 font-light italic">No se encontraron productos.</p>';
            return;
        }

        grid.innerHTML = products.map(p => {
            const price = p.price ? new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(p.price) : '';
            const hasStock = p.stock > 0;
            const imgUrl = p.image_url || 'https://placehold.co/400x400/fafafa/e0e0e0?text=MB';

            return `
                <div class="group relative bg-white border border-transparent hover:border-gray-100 hover:shadow-2xl transition-all duration-500 p-4 flex flex-col">
                    <div class="relative h-64 overflow-hidden bg-[#fff] mb-6 flex items-center justify-center">
                        <img src="${imgUrl}" 
                             alt="${p.name}"
                             class="max-h-full max-w-full object-contain transform group-hover:scale-110 transition-transform duration-700"
                             onerror="this.src='https://placehold.co/400x400/fafafa/e0e0e0?text=MB'">
                        ${!hasStock ? '<div class="absolute inset-0 bg-white/60 flex items-center justify-center"><span class="bg-dark text-white text-xs px-3 py-1 uppercase tracking-widest">Agotado</span></div>' : ''}
                        <div class="absolute bottom-0 left-0 w-full bg-white/90 backdrop-blur-sm p-3 translate-y-full group-hover:translate-y-0 transition-transform duration-300 border-t border-gray-100 flex justify-center">
                            <button onclick="showProductDetail('${p.product_id}')" class="text-dark hover:text-gold text-xs uppercase tracking-widest font-bold">Ver Detalles</button>
                        </div>
                    </div>
                    <div class="text-center flex-1 flex flex-col items-center">
                        <span class="text-[10px] text-gray-400 uppercase tracking-[0.2em] mb-2">${p.brand}</span>
                        <h3 class="font-serif text-lg text-dark mb-2 leading-tight group-hover:text-gold transition-colors line-clamp-2">${p.name}</h3>
                        <p class="text-xs text-gray-400 mb-2">${p.volume || ''}</p>
                        ${price ? `<div class="mt-auto pt-2 border-t border-gray-50 w-full"><span class="text-dark font-medium">${price}</span></div>` : ''}
                    </div>
                </div>`;
        }).join('');
    }

    function setupFilters(allProducts) {
        const brandSelect = document.getElementById('brand-filter');
        const sortSelect = document.getElementById('sort-by');

        const apply = () => {
            let filtered = [...allProducts];

            const brand = brandSelect.value;
            if(brand !== 'todos') filtered = filtered.filter(p => p.brand === brand);

            const sort = sortSelect.value;
            if(sort === 'precio_asc') filtered.sort((a,b) => (a.price || 0) - (b.price || 0));
            if(sort === 'precio_desc') filtered.sort((a,b) => (b.price || 0) - (a.price || 0));

            renderProducts(filtered);
        };

        brandSelect.addEventListener('change', apply);
        sortSelect.addEventListener('change', apply);
    }

    function showProductDetail(productId) {
        const product = PRODUCTS.find(p => p.product_id === productId);
        if(!product) return;
        
        const price = new Intl.NumberFormat('es-MX', { style: 'currency', currency: 'MXN' }).format(product.price);
        alert(`${product.name}\n${product.brand}\n${price}\n\nContacta para más información.`);
    }

    function initChat() {
        const toggle = document.getElementById('chat-toggle');
        const close = document.getElementById('close-chat');
        const widget = document.getElementById('chat-widget');
        const form = document.getElementById('chat-form');
        const input = document.getElementById('chat-input');
        const msgs = document.getElementById('chat-messages');

        const toggleFn = () => {
            widget.classList.toggle('chat-widget-active');
            widget.classList.toggle('chat-widget-enter');
        }

        toggle.addEventListener('click', toggleFn);
        close.addEventListener('click', toggleFn);

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const text = input.value.trim();
            if(!text) return;

            msgs.innerHTML += `<div class="bg-gold text-white p-3 shadow-sm self-end ml-auto max-w-[90%] text-right mb-2 text-sm">${text}</div>`;
            input.value = '';
            msgs.scrollTop = msgs.scrollHeight;

            setTimeout(() => {
                msgs.innerHTML += `<div class="bg-white p-3 shadow-sm border border-gray-100 text-gray-600 max-w-[90%] self-start mb-2 text-sm">Gracias. Un asesor le responderá pronto vía WhatsApp.</div>`;
                msgs.scrollTop = msgs.scrollHeight;
            }, 1000);
        });
    }
</script>
</body>
</html>
